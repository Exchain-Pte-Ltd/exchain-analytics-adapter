<!DOCTYPE html>
<html>
  <head>
    <title>ExChain Analytics Adapter v3.2.10 - Prebid Build Demo</title>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1">
    
    <!-- 
    üîß IMPORTANT: This example assumes you've built Prebid.js with ExChain module included
    
    Build Steps:
    1. git clone https://github.com/prebid/Prebid.js.git
    2. cd Prebid.js
    3. wget https://raw.githubusercontent.com/Exchain-Pte-Ltd/exchain-analytics-adapter/main/src/exchainAnalyticsAdapter/exchainAnalyticsAdapter.js -O modules/exchainAnalyticsAdapter.js
    4. gulp build --modules=exchainAnalyticsAdapter,appnexus (add your bidders)
    5. Copy build/dist/prebid.js to this example directory
    -->
    
    <!-- Load your custom-built Prebid.js (with ExChain module included) -->
    <script src="./prebid.js"></script>
    
    <!-- Google Publisher Tag -->
    <script src="https://securepubads.g.doubleclick.net/tag/js/gpt.js"></script>
    
    <!-- Demo script -->
    <script src="./index.js"></script>
    
    <style>
      body { font-family: Arial, sans-serif; margin: 20px; }
      .instructions { background: #f5f5f5; padding: 15px; margin: 20px 0; border-radius: 5px; }
      .ad-slot { border: 2px dashed #ccc; min-height: 250px; padding: 10px; text-align: center; background: #fafafa; }
      .console-note { background: #e8f4fd; padding: 10px; margin: 10px 0; border-left: 4px solid #2196F3; }
      .new-feature { background: #e8f5e8; padding: 10px; margin: 10px 0; border-left: 4px solid #4caf50; }
      .debug-box { background: #fff3cd; padding: 10px; margin: 10px 0; border: 1px solid #ffeaa7; border-radius: 5px; }
    </style>
  </head>

  <body>
    <h1>üöÄ ExChain Analytics Adapter v3.2.10 Demo</h1>
    
    <div class="new-feature">
      <h3>üîÑ New in v3.2.10:</h3>
      <p><strong>Unique IOID per Auction Cycle!</strong> Each call to <code>pbjs.requestBids()</code> now generates a fresh, unique IOID (like Transaction IDs).</p>
    </div>
    
    <div class="instructions">
      <h3>üìã Setup Instructions:</h3>
      <ol>
        <li>Build Prebid.js with ExChain module: <code>gulp build --modules=exchainAnalyticsAdapter,appnexus</code></li>
        <li>Copy the built <code>prebid.js</code> file to this directory</li>
        <li>Open this page and check browser console for IOID generation logs</li>
        <li><strong>Test multiple auctions</strong> to verify IOID uniqueness</li>
      </ol>
    </div>
    
    <div class="console-note">
      <strong>üí° Check Browser Console:</strong> Open DevTools Console to see real-time unique IOID generation and ORTB2 injection logs
    </div>
    
    <h3>üì∫ Ad Slot (300x250)</h3>
    <div id='div-1' class="ad-slot">
      <p>Ad will load here after bid process completes...</p>
      <script type='text/javascript'>
        googletag.cmd.push(function() {
          googletag.display('div-1');
        });
      </script>
    </div>
    
    <div class="debug-box">
      <h3>üß™ Test IOID Uniqueness (v3.2.10)</h3>
      <p>Run these commands in console to verify unique IOID generation:</p>
      <code>
        // Test 1: Check current IOID<br>
        pbjs.getConfig('ortb2').site.ext.data.ioids[0]<br><br>
        
        // Test 2: Trigger new auction and check for different IOID<br>
        pbjs.requestBids(); setTimeout(() => console.log('New IOID:', pbjs.getConfig('ortb2').site.ext.data.ioids[0]), 1000);<br><br>
        
        // Test 3: Automated uniqueness test<br>
        pbjs.modules.exchainAnalyticsAdapter.debug.testIOIDUniqueness();
      </code>
    </div>
    
    <div class="instructions">
      <h3>üîç What to Look For:</h3>
      <ul>
        <li><strong>Console Logs:</strong> v3.2.10 version identification and unique IOID generation messages</li>
        <li><strong>IOID Uniqueness:</strong> Each auction should show different IOID values</li>
        <li><strong>Network Tab:</strong> Bid requests should include current auction's IOID in keywords</li>
        <li><strong>Prebid Debug:</strong> <code>pbjs.getConfig('ortb2')</code> should show current auction's unique IOID</li>
        <li><strong>Module Status:</strong> <code>pbjs.installedModules.includes('exchainAnalyticsAdapter')</code> should return true</li>
      </ul>
    </div>
    
    <div class="console-note">
      <h3>üìä Expected Console Output (v3.2.10):</h3>
      <pre>
‚úÖ ExChain Analytics v3.2.10: Pre-generation strategy initialized successfully
‚úÖ ExChain Analytics v3.2.10: Generated unique IOID from immediate-pre-generation: abc123...
‚úÖ ExChain Analytics v3.2.10: RequestBids pre-generation hook installed
üìç ExChain Analytics v3.2.10: Initial ORTB2 IOID: abc123...
üîÑ ExChain Analytics v3.2.10: Generated unique IOID from requestBids-pre-generation: def456... (auction: xyz789)
      </pre>
    </div>
  </body>
</html>